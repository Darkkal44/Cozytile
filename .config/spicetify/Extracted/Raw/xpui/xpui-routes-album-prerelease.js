"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[9540],{7071:(e,n,i)=>{i.d(n,{g:()=>r});var a=i(51005),t=i(54451),l=i(4637);const r=({children:e})=>(0,l.jsx)(a.D,{variant:"mesto",className:t.Z.pretitle,children:e})},59522:(e,n,i)=>{i.d(n,{x:()=>u});var a=i(59496),t=i(79086),l=i(60433),r=i(84463),s=i(50293),d=i(8177),o=i(65980),m=i(4637);const u=({children:e,action:n,uri:i})=>{const u=(0,l.g)(),c=(0,s.j)();let k;const v=()=>{const e={triggerId:o.K,triggerAction:{type:n}};d.y.set((n=>({...n,...e}))),c.storeAction(r.wH,{operation:t.pT.ADD,uris:[i]})};try{k=a.Children.only(e)}catch(n){return(0,m.jsx)(m.Fragment,{children:e})}return u?a.cloneElement(k,{onClick:v}):(0,m.jsx)(m.Fragment,{children:e})}},70934:(e,n,i)=>{i.r(n),i.d(n,{AlbumPrerelease:()=>Be});var a=i(84875),t=i.n(a),l=i(13841),r=i(51005),s=i(93017),d=i(99302),o=i(19929),m=i(17246),u=i(55993),c=i(59496),k=i(97973),v=i(41432),p=i(92499);function S(e){const n=new Date;return(e instanceof Date?e:new Date(e)).getTime()-n.getTime()}var N=i(76285),y=i(36208),g=i(4637);const b=({uri:e})=>{const n=(0,y.D)(e),{spec:i,logger:a}=(0,p.fU)(k.j,{data:{uri:e||""}}),t=(0,c.useCallback)((()=>{e&&(a.logInteraction(i.actionBarFactory().preSaveButtonFactory().hitUiNavigate({destination:e})),n())}),[n,i,e,a]);return e?(0,g.jsx)(N.D,{onClick:t,children:d.ag.get("web-player.album-prerelease.listen_now")}):null};var F=i(7215),f=i(59522),h=i(80731);const x=3e5,P=36e5;var R=i(71876);const D={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"preReleaseMutationPayload"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreReleasePayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"preRelease"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreRelease"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"preSaved"}}]}}]}}]}}]},T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"AlbumPrereleasePreSavedState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lookup"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uris"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"uri"}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreReleaseResponseWrapper"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"data"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreRelease"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"preSaved"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotFound"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}}]}}]}}]}}]}}]},j={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PreSaveAlbumPrerelease"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"preSavePreReleaseToLibrary"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"preReleaseMutationPayload"}}]}}]}},...D.definitions]},C={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RemovePreSaveAlbumPrerelease"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removePreReleaseFromLibrary"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"preReleaseMutationPayload"}}]}}]}},...D.definitions]},_=e=>{const{data:n,invalidate:i,loading:a}=(t={uri:e},l={staleTime:x,cacheTime:P},(0,R.a)(T,t,l));var t,l;return{isPreSaved:(0,c.useMemo)((()=>{if(!n)return!1;for(const i of n.lookup)if("PreReleaseResponseWrapper"===i.__typename&&"PreRelease"===i.data.__typename&&i.data.uri===e)return i.data.preSaved;return!1}),[n,e]),isLoading:a,invalidate:i}};var I=i(9102),A=i(55411),L=i(92454),w=i(78086),U=i(79939),M=i(69763);const V=(e,n)=>{const{request:i}=(0,c.useContext)(L.Ax),a=(0,A.I0)();return(0,I.useMutation)((async n=>{const a=n?j:C,t=await(0,w.J)(i,a,{uri:e}),l=t?.data;if(l)return function(e){let n;if("preSavePreReleaseToLibrary"in e&&"PreReleasePayload"===e.preSavePreReleaseToLibrary.__typename)n=e.preSavePreReleaseToLibrary.preRelease;else{if(!("removePreReleaseFromLibrary"in e)||"PreReleasePayload"!==e.removePreReleaseFromLibrary.__typename)return;n=e.removePreReleaseFromLibrary.preRelease}switch(n.__typename){case"PreRelease":return n.preSaved;case"NotFound":return!1;case"GenericError":return;default:return void(0,U._)(n)}}(l)}),{onSuccess:e=>{"boolean"==typeof e&&(e&&a((0,M.c)()),n(e))}})};const E=({uri:e})=>{const{isPreSaved:n,isLoading:i,addPresave:a,removePresave:t}=(e=>{const{isPreSaved:n,invalidate:i,isLoading:a}=_(e),{mutate:t,isLoading:l}=V(e,i);return{isPreSaved:n,isLoading:a||l,addPresave:(0,c.useCallback)((()=>t(!0)),[t]),removePresave:(0,c.useCallback)((()=>t(!1)),[t])}})(e),{spec:l,logger:r}=(0,p.fU)(k.j,{data:{uri:e}}),s=()=>{r.logInteraction(l.actionBarFactory().preSaveButtonFactory().hitRemovePresave({prereleaseId:e,itemToBeRemovedFromPresaved:e,contextUri:e})),t()};return n?(0,g.jsx)(F.P,{disabled:i,onClick:s,children:d.ag.get("web-player.album-prerelease.presaved")}):(0,g.jsx)(f.x,{uri:e,action:h.sr.SAVE_PRERELEASE,children:(0,g.jsx)(N.D,{disabled:i,onClick:()=>{r.logInteraction(l.actionBarFactory().preSaveButtonFactory().hitPresave({prereleaseId:e,itemToBePresaved:e,contextUri:e})),a()},children:d.ag.get("web-player.album-prerelease.presave")})})};var B=i(20274),O=i(67866),W=i(66097),H=i(6721),Q=i(29328),Z=i(72390);const q=c.memo((function({uri:e,artistUri:n}){const{spec:i}=(0,Q.T)(e);return(0,g.jsx)(H.ZP,{value:"album",children:(0,g.jsxs)(W.v,{children:[n&&(0,g.jsx)(Z.Jh,{spec:i,divider:"after",uri:n,displayText:d.ag.get("contextmenu.go-to-artist-radio")}),(0,g.jsx)(Z.Jx,{uri:e,spec:i,displayText:d.ag.get("context-menu.copy-album-link")}),(0,g.jsx)(Z.h$,{spec:i,divider:"before",uri:e})]})})}));var z=i(16786);const G=({prerelease:e,backgroundColor:n})=>{const i=function(e){const[n,i]=(0,c.useState)((()=>!!e&&S(e)<=0));return(0,c.useEffect)((()=>{if(!e)return;const n=S(e);if(n<=0)return void i(!0);if(n>=36e5)return void i(!1);const a=setTimeout((()=>{i(!0)}),n);return()=>{clearTimeout(a)}}),[e]),n}(e.releaseDate),{spec:a,UBIFragment:t}=(0,p.fU)(k.j,{data:{uri:e.uri}}),l=(0,z.j)();return(0,g.jsx)(B.o,{backgroundColor:n,children:(0,g.jsxs)(B.F,{children:[i?(0,g.jsx)(b,{uri:e.content?.uri}):(0,g.jsx)(E,{uri:e.uri}),(0,g.jsx)(t,{spec:a,children:(0,g.jsx)(v.ClickToggleContextMenu,{menu:(0,g.jsx)(q,{uri:e.uri,artistUri:e.content?.artists[0].uri}),children:(0,g.jsx)(O.MoreButton,{label:d.ag.get("more.label.context",e.content?.name),size:l})})})]})})};var J=i(70657),K=i(13743),Y=i(64283);const $="J9GZWbcqWAQBbj0mGgBp",X="MnacN8FHHYBeSU8hx4U8",ee="HBgE42egR1M0MoBZt7MA",ne="l5yLFFUEplqPqkpdgn2z",ie="g0_tYvLXcZhPQLQuecrg",ae="gjeF0mGZlmvlsLy5SvfQ",te=({value:e,label:n,hasDivider:i=!1})=>(0,g.jsxs)("div",{className:ee,"aria-hidden":"true",children:[(0,g.jsx)(r.D,{variant:"canon",className:t()({[ie]:i}),children:e}),(0,g.jsx)(r.D,{variant:"finale",semanticColor:"textSubdued",children:n})]});var le=i(60488);const re=1e3,se=60*re,de=60*se,oe=24*de;const me={days:0,hours:0,minutes:0,seconds:0};function ue(e){return e>0?function(e){const n=Math.abs(e);return{days:Math.floor(n/oe),hours:Math.floor(n%oe/de),minutes:Math.floor(n%de/se),seconds:Math.floor(n%se/re)}}(e):me}const ce=({targetDate:e,className:n,onComplete:i,images:a,imageTitle:l})=>{const{days:r,hours:s,minutes:o,seconds:m}=((e,n)=>{const i=(0,c.useRef)(n);i.current=n;const[a,t]=(0,c.useState)((()=>ue(S(e))));return(0,le.Y)((n=>{const a=S(e),l=ue(a);t(l),a<=0&&(n(),i.current?.())}),1e3),a})(e,i),k=void 0!==a&&a.length>0&&l,v=d.ag.get("web-player.album-prerelease.countdown_label",{days:r,hours:s,minutes:o,seconds:m});return(0,g.jsxs)("div",{className:t()($,n,{[X]:k}),role:"timer",children:[(0,g.jsx)("span",{className:ae,children:v}),k&&(0,g.jsx)(Y.O,{images:a,type:u.p.ALBUM,shape:Y.K.ROUNDED_CORNERS,className:ne,title:l}),(0,g.jsx)(te,{value:r,label:d.ag.get("web-player.album-prerelease.days",r),hasDivider:!0}),(0,g.jsx)(te,{value:s,label:d.ag.get("web-player.album-prerelease.hours",s),hasDivider:!0}),(0,g.jsx)(te,{value:o,label:d.ag.get("web-player.album-prerelease.minutes",o),hasDivider:!0}),(0,g.jsx)(te,{value:m,label:d.ag.get("web-player.album-prerelease.seconds",m)})]})};var ke=i(31267),ve=i(82289),pe=i(38730),Se=i(7071);const Ne="xjbmV4vvBCu7c5U6nAgL",ye=({prerelease:e,children:n})=>(0,g.jsx)(v._,{menu:(0,g.jsx)(q,{uri:e.uri,artistUri:e.content?.artists[0].uri}),children:n}),ge=({prerelease:e,backgroundColor:n})=>{const{content:i,releaseDate:a}=e,t=(0,J.jh)(),l=t===J.Uo.SMALL||t===J.Uo.XSMALL,{spec:r,logger:s}=(0,p.fU)(k.j,{data:{uri:e.uri}}),d=(0,c.useCallback)(((e,n)=>{if(r){const e=r.headerFactory().artistNameFactory().hitUiNavigate({destination:n.creator.uri});s.logInteraction(e)}}),[s,r]),o=i,m=(0,c.useMemo)((()=>a?new Date(a):void 0),[a]);return(0,g.jsxs)(ke.gF,{backgroundColor:n,size:ke.fR.LARGE,children:[(0,g.jsx)(ve.W,{children:o.name?(0,g.jsx)(pe.i,{text:o.name}):null}),!l&&(0,g.jsx)(ye,{prerelease:e,children:(0,g.jsx)(ke.Oz,{images:o.coverArt.sources,name:o.name??"",placeholderType:"album"})}),(0,g.jsxs)(ke.sP,{children:[(0,g.jsx)(Se.g,{children:(0,K.R)(o.type)}),(0,g.jsx)(ye,{prerelease:e,children:(0,g.jsx)(ke.xd,{scaleAtMinWidth:ke.Fi,children:o.name})}),(0,g.jsx)(ke.QS,{creators:o.artists,onCreatorClick:d,releaseDate:a,timeZone:e.timezone}),m&&o.name?(0,g.jsx)(ce,{images:l?o.coverArt.sources:[],className:Ne,imageTitle:o.name,targetDate:m}):null]})]})};var be=i(76933),Fe=i(54067);const fe={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"albumPreReleaseTrackArtistItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ArtistResponseWrapper"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"data"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Artist"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]}}]},he={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"albumPreReleaseTracks"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"limit"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lookup"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uris"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"uri"}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreReleaseResponseWrapper"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"data"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"albumPreReleaseTracksData"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotFound"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumPreReleaseTracksData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreRelease"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"preReleaseContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tracks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"Variable",name:{kind:"Name",value:"offset"}}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"Variable",name:{kind:"Name",value:"limit"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumPreReleaseTrack"}}]}},{kind:"Field",name:{kind:"Name",value:"totalCount"}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumPreReleaseTrack"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreReleaseAlbumTrack"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"artists"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumPreReleaseTrackArtistItem"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}},...fe.definitions]},xe={totalLength:0,items:[]};function Pe(e){const n=e.preReleaseContent,i=[];if(n?.tracks)for(const e of n.tracks.items)i.push({uri:e.uri,name:e.name?e.name:"",isPlayable:e.playability.playable,durationMs:e.duration?.totalMilliseconds??0,artists:Re(e.artists.items),isExplicit:e.contentRating?.label===Fe.KS.Explicit,is19PlusOnly:e.contentRating?.label===Fe.KS.NineteenPlus});return{totalLength:n?.tracks.totalCount??0,items:i}}function Re(e){const n=[];for(const i of e)"Artist"===i.data.__typename&&n.push({name:i.data.profile.name,uri:i.data.uri});return n}const De=c.memo((function({ariaLabel:e,nrTracks:n,prereleaseUri:i,highlightUri:a,scrollToIndex:t,usePlayContextItem:l,hasHeaderRow:r=!0,initalTracks:s}){const{spec:d,UBIFragment:o}=(0,p.fU)(k.j,{data:{uri:i}}),m=(e=>{const{request:n}=(0,c.useContext)(L.Ax);return(0,c.useCallback)((async(i,a)=>{const t=await n(he,{uri:e,offset:i,limit:a});for(const n of t?.data?.lookup||[])if("PreReleaseResponseWrapper"===n.__typename&&"PreRelease"===n.data.__typename&&n.data.uri===e)return Pe(n.data);return xe}),[n,e])})(i),u=(0,c.useRef)(!1),v=(0,c.useRef)(null),[S,N]=(0,c.useState)(null),y=(0,c.useCallback)((e=>e.uri),[]);(0,c.useEffect)((()=>{v.current&&(S?v.current.scrollToIndex(S):t&&v.current.scrollToIndex(t))}),[S,t]);const b=(0,c.useCallback)((async(e,n)=>{const i=await m(e,n);if(a&&!S){const e=i.items.findIndex((e=>e?.uri===a));N(e||-1)}return i}),[m,a,S]),F=(0,c.useCallback)(((e,n)=>{const t=!u.current&&!!a&&a===e.uri;return t&&(u.current=!0),(0,g.jsx)(be.Ym,{uri:e.uri,isPlayable:e.isPlayable,name:e.name,trackNumber:n+1,index:n,artists:e.artists,playcount:0,contextUri:i,duration_ms:e.durationMs,shouldRenderPlayCount:!1,usePlayContextItem:l,isMOGEFRestricted:e.is19PlusOnly,isExplicit:e.isExplicit,shouldHighLight:t,isReleased:e.isPlayable},n+e.uri)}),[a,i,l]);return(0,g.jsx)(o,{spec:d,children:(0,g.jsx)(be.Pv,{ariaLabel:e,hasHeaderRow:r,rowPlaceholder:be.uD,columns:[be.QD.INDEX,be.QD.TITLE,be.QD.DURATION],renderRow:F,resolveUri:y,nrTracks:n,fetchTracks:b,limit:300,tracks:s,outerRef:v},i)})}));var Te=i(41276),je=i(68368),Ce=i(62412);const _e={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"albumPreRelease"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lookup"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uris"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"uri"}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreReleaseResponseWrapper"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"data"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"albumPreReleaseData"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotFound"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumPreReleaseData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreRelease"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"preReleaseContent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"artists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumPreReleaseArtistItem"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"coverArt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"extractedColors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colorRaw"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hex"}},{kind:"Field",name:{kind:"Name",value:"isFallback"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"tracks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumPreReleaseTrack"}}]}},{kind:"Field",name:{kind:"Name",value:"totalCount"}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"copyright"}}]}},{kind:"Field",name:{kind:"Name",value:"releaseDate"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isoString"}}]}},{kind:"Field",name:{kind:"Name",value:"timezone"}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumPreReleaseArtistItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ArtistResponseWrapper"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"data"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Artist"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}}]}},{kind:"Field",name:{kind:"Name",value:"visuals"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarImage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"width"}}]}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumPreReleaseTrack"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PreReleaseAlbumTrack"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"artists"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumPreReleaseTrackArtistItem"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"duration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalMilliseconds"}}]}},{kind:"Field",name:{kind:"Name",value:"playability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playable"}}]}},{kind:"Field",name:{kind:"Name",value:"contentRating"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}},...fe.definitions]},Ie=(e,n)=>(0,R.a)(_e,e,n),Ae=(e,n=Ie)=>{const{data:i,loading:a,error:t}=n({uri:e},{staleTime:x,cacheTime:P});return{loading:a,error:!!t,prerelease:(0,c.useMemo)((()=>{if(!i)return null;for(const n of i.lookup)if("PreReleaseResponseWrapper"===n.__typename&&"PreRelease"===n.data.__typename&&n.data.uri===e)return we(n.data);return null}),[i,e])}};function Le(e){return e.includes("℗")?{type:"P",text:e}:{type:"C",text:e}}function we(e){const n=e.preReleaseContent;let i;if(n){const a=Pe(e);i={artists:Ue(n.artists.items),name:n.name??void 0,uri:n.uri,coverArt:{extractedColors:n.coverArt?.extractedColors?.colorRaw,sources:n.coverArt?.sources??[]},type:n.type,tracks:a,copyrights:n.copyright?.split("\n").map(Le)??[]}}return{uri:e.uri,releaseDate:e.releaseDate?.isoString,timezone:e.timezone??void 0,content:i}}function Ue(e){const n=[];for(const i of e)"Artist"===i.data.__typename&&n.push({name:i.data.profile.name,id:i.data.id,uri:i.data.uri,images:i.data.visuals.avatarImage?.sources??[]});return n}var Me=i(25672);const Ve="H2kQJCtEGTjIDaPPniwb",Ee="ZSU92ZH1fIuGwPp1cuDi",Be=e=>{const{uri:n}=e,{prerelease:i,loading:a,error:c}=Ae(n),k=(e=>{const n=e?.content?.coverArt.extractedColors?.hex;return(0,Me.Y)(n),n})(i),v=parseInt(new URLSearchParams((0,l.TH)().search).get("index")||"0",10),{usePlayContextItem:p}=(0,m.n)({uri:n,pages:[{items:(N=i?.content?.tracks.items||[],N.filter((e=>e.isPlayable)).map((e=>({uri:e.uri,uid:null,type:u.p.TRACK,provider:null}))))}]},{featureIdentifier:"album_prerelease"});var N;if(a||c||!i)return(0,g.jsx)(je.h,{hasError:!!c,errorMessage:d.ag.get("error.not_found.title.album")});if(i?.content?.uri&&function(e,n){if(!e.content?.uri||!e.releaseDate)return!1;const i=S(e.releaseDate);if(i>0)return!1;return i<=-1*n}(i,1728e5)){const e=(0,s._b)(i?.content?.uri);if(e)return(0,g.jsx)(Ce.InstrumentedRedirect,{to:e.toURLPath(!0)})}return(0,g.jsxs)("section",{className:Ve,children:[(0,g.jsx)(Te.$,{children:d.ag.get("album.page-title",i.content?.name??"")}),(0,g.jsx)(ge,{prerelease:i,backgroundColor:k}),(0,g.jsx)(G,{prerelease:i,backgroundColor:k}),i.content?.tracks.totalLength?(0,g.jsxs)("div",{className:"contentSpacing",children:[(0,g.jsx)(r.D,{as:"h2",variant:"canon",semanticColor:"textBase",children:d.ag.get("web-player.album-prerelease.tracklist_preview")}),(0,g.jsx)(De,{prereleaseUri:n,ariaLabel:i.content?.name??d.ag.get("error.not_found.title.album"),nrTracks:i.content?.tracks.totalLength??0,scrollToIndex:v,usePlayContextItem:p,initalTracks:i.content?.tracks.items,albumUri:i.content?.uri})]}):null,(0,g.jsx)("div",{className:t()(Ee,"contentSpacing"),children:(0,g.jsx)(o.k,{copyrights:i.content?.copyrights??[]})})]})}},19929:(e,n,i)=>{i.d(n,{k:()=>r});var a=i(51005);const t="rTMkDBDp47Eo12ZEQv4U";var l=i(4637);const r=({copyrights:e,courtesyLine:n})=>{const i=(e||[]).map(((e,n)=>{const i=e.text.replace(/^(\(C\)\s+)/,"").replace(/^(\(P\)\s+)/,"").replace(/^(©\s+)/,"").replace(/^(℗\s+)/,"");let t;return t="C"===e.type?"©":"P"===e.type?"℗":`(${e.type})`,(0,l.jsx)(a.D,{as:"p",variant:"finale",dir:"auto",children:`${t} ${i}`},n)}));return n&&i.unshift((0,l.jsx)(a.D,{as:"p",variant:"finale",dir:"auto",children:n},i.length)),(0,l.jsx)("div",{className:t,children:i})}}}]);
//# sourceMappingURL=xpui-routes-album-prerelease.js.map