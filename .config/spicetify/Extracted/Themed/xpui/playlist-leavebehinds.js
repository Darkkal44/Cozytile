"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[5457],{90981:(e,s,t)=>{t.r(s),t.d(s,{default:()=>I});var l=t(59496),a=t(55411),i=t(13593),r=t(93017),n=t(46301),d=t(12861),u=t(92375),c=t(26302),o=t(61326),f=t(99302),h=t(63566),p=t(4637);const v=({leavebehinds:e,surface:s,playlistUri:t,playlistId:l})=>{const a=(0,n.s4)(),i=`${f.ag.get("view.see-all")} (${e.length<=h.fz?f.ag.formatNumber(e.length):f.ag.formatNumber(h.fz)})`;return(0,p.jsx)(u.rU,{to:`/playlist/${l}/see-all-ads`,state:{playlistUri:t},children:(0,p.jsx)(c.o,{"data-testid":"leavebehinds-see-all",buttonSize:"sm",onClick:()=>{a.send((0,o.a)({leavebehind_request_id:e[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:s,uri:t}))},children:i})})};var y=t(17582),b=t(18809),_=t(68595);var m=t(4904),g=t(16382);const I=({playlistUri:e,playlistName:s})=>{const t=(0,r.EC)(e)?.id,u=(0,a.v9)(g.N),c=u?.some((e=>e.playlistId===t)),o=(0,y.OO)(y.Tg.PLAYLIST),f=(0,a.I0)(),I=(0,n.s4)(),A=(0,a.v9)((e=>e.ads?.musicLeavebehinds?.playlistId)),N=(0,a.v9)((e=>e.ads.musicLeavebehinds.fetchingState)),U=(0,a.v9)(g.v),k=(0,h.eh)();(0,l.useEffect)((()=>{const l=async()=>{if(t&&!c){f((0,m.ZN)(t));try{const t=await(({uri:e,playlistName:s,url:t})=>_.adsCosmos.post(t,{surface:(0,y.OO)(y.Tg.PLAYLIST),uri:e,playlistTitle:s}))({uri:e,playlistName:s,url:k});f((0,m.Gr)((0,h.D7)({requestId:t.requestId,leavebehindAds:t.leavebehindAds},e)))}catch(e){f((0,m.tD)());const s=e;I.send((0,i.v)({error_type:"fetchAdsFailure",error_message:s.name,http_error_code:s.status,surface:o,request_url:k,request_type:"leavebehindAds",ad_content_origin:"music"}))}}};A!==t&&l()}),[f,I,c,A,N,t,s,e,o,k]);const q=(0,l.useMemo)((()=>U.slice(0,h.aV)),[U]);return N===b.I.FETCHED&&U.length>0&&t&&e===U[0].playlistUri?(0,p.jsx)(d._,{surface:o,playlistUri:e,leavebehinds:q,seeAllButton:U.length>h.aV?(0,p.jsx)(v,{leavebehinds:U,surface:o,playlistId:t,playlistUri:e}):null}):null}}}]);
//# sourceMappingURL=playlist-leavebehinds.js.map